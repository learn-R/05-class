11/26
3/11
8/11
install.packages("pacman")
install.packages("pacman")
library (pacman)
pacman::p_load(tidyverse,
magrittr,
car,
sjmisc)
temp <- tempfile()
download.file("http://observatorio.ministeriodesarrollosocial.gob.cl/storage/docs/casen/2020/Casen_en_Pandemia_2020_STATA.dta.zip",temp)
datos <- haven::read_dta(unz(temp, "Casen en Pandemia 2020 STATA.dta"))
unlink(temp); remove(temp)
datos <- read_dta("../Rproject/input/Casen en Pandemia 2020 STATA.dta")
# De paquete base
dim(datos) # nos entrega las dimensiones, es decir el numero de observaciones y el número de variables
View(datos) # se usa para visualizar la base de datos
names(datos) # entrega los nombres de las variables que componen el dataset
head(datos) # muestra las primeras filas presentes en el marco de datos
find_var(datos, "concepto") # se utiliza para encontrar variables
select(datos, variable1, variable2, variable3) #Incluir variables
select(datos, 1, 2) # la primera y la segunda columna
select(datos, 1:4) # la primera hasta la cuarta columna
select(datos, c(1,4)) # la primera y la cuarta columna
select(datos, edad, sexo, ocupacion = o1)
select(datos, id_persona, sexo, edad, everything())
select(datos, starts_with("a"), ends_with("preg"))
select(datos, starts_with("y1")&ends_with("preg"))
select(datos, contains("pobre")|contains("vivienda"))
select(datos, matches("pobreza_|vivienda"))
select(datos, where(is.character))
datos_proc <- select(datos, edad, sexo, prev = 592, ocupacion = o1,
tot_per, ytoth, starts_with("y26d_")&matches("total|hog"))
filter(datos_proc, edad >= 15)
filter(datos_proc, edad >= 15 & tot_per <7)
filter(datos_proc, ytoth == max(ytoth))
filter(datos_proc, sexo == "Mujer")
filter(datos_proc, sexo != "Hombre")
datos_proc$prev <- as_factor(datos_proc$prev)
filter(datos_proc, prev %in% c("Sistema Público FONASA", "ISAPRE"))
mutate(datos_proc, nueva_variable = 3+2)
mutate(datos_proc, nueva_variable = 3+2,
ingreso_percapita = ytoth/tot_per)
datos_proc %>%
mutate(ingreso_percapita = ytoth/tot_per) %>%
filter(ingreso_percapita <= 1000000)
datos_proc %>%
mutate(sexo = recode(sexo, "Mujer" = "Femenino", "Hombre" = "Masculino"))
datos_proc %$%
car::recode(.$sexo, c('"Mujer"="Femenino";"Hombre"= "Masculino"'), as.factor = T)
View(datos_proc)
datos_proc %>%
mutate(sexo = recode(sexo, "Mujer" = "Femenino", "Hombre" = "Masculino"))
frq(datos_proc$sexo)
datos_proc %>%
mutate(sexo = recode(sexo, 2 = "Mujer", 1 = "Hombre"))
datos_proc %>%
mutate(sexo = recode(sexo, 2 = "Mujer", 1 = "Hombre"))
datos_proc %$%
car::recode(.$sexo, c('"Mujer"="Femenino";"Hombre"= "Masculino"'), as.factor = T)
datos_proc %>%
mutate(fonasa = if_else(prev == "Sistema Público FONASA", 1, 0))
datos_proc %>%
mutate(edad_tramo = case_when(edad <=39 ~  "Joven",
edad > 39 & edad <=59 ~ "Adulto",
edad > 59 ~ "Adulto mayor",
TRUE ~ NA_character_)) %>%
select(edad, edad_tramo)
datos_proc <- datos_proc %>%
filter(edad >= 15 & tot_per <7) %>%
mutate(ingreso_percapita = ytoth/tot_per,
edad_tramo = case_when(edad <=39 ~  "Joven",
edad > 39 & edad <=59 ~ "Adulto",
edad > 59 ~ "Adulto mayor",
TRUE ~ NA_character_),
fonasa = if_else(prev == "Sistema Público FONASA", 1, 0),
ocupacion = as_factor(ocupacion)) %>%
select(sexo, edad_tramo, ocupacion, ingreso_percapita, ife = y26d_hog)
sjPlot::view_df(datos_proc)
saveRDS(datos_proc, file = "../nombre_project/output/datos_proc.rds")
saveRDS(datos_proc, file = "output/data/datos_proc.rds")
